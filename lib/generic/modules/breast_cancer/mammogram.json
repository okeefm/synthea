{
  "name": "Breast Cancer Mammography",
  "remarks": [
    "Data for this module was obtained from the following sources:",
    "1. Mammography statistics: http://www.bcsc-research.org/statistics/performance/screening/index.html",
    "2. Mammography followup statistics: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3151253/"
  ],
  "states": {
    "Initial": {
      "type": "Initial",
      "direct_transition": "MammogramEncounterSelect"
    },

    "MammogramEncounterSelect": {
      "type": "Simple",
      "complex_transition": [
        {
          "condition": {
            "condition_type": "Age",
            "operator": ">",
            "quantity": 74,
            "unit": "years"
          },
          "transition": "Terminal"
        },
        {
          "condition": {
            "condition_type": "Or",
            "conditions": [
              {
                "condition_type": "PriorState",
                "name": "MammogramEncounterSelect",
                "within": { "quantity": 2, "unit": "years"}
              },
              {
                "condition_type": "Age",
                "operator": "<",
                "quantity": 40,
                "unit": "years"
              }
            ]
          },
          "transition": "Terminal"
        },
        {
          "distributions": [
            {
              "distribution": 0.65,
              "transition": "BiennialMammogramEncounter"
            },
            {
              "distribution": 0.35,
              "transition": "Terminal"
            }
          ]
        }
      ]
    },

    "BiennialMammogramEncounter" : {
      "type": "Encounter",
      "wellness": true,
      "direct_transition": "MammogramProcedure"
    },

    "MammogramProcedure": {
      "type": "Procedure",
      "target_encounter": "BiennialMammogramEncounter",
      "duration" : { "low" : 20, "high" : 30, "unit" : "minutes" },
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "24623002",
          "display": "Screening Mammography (procedure)"
        }
      ],
      "conditional_transition": [
        {
          "condition": {
            "condition_type": "Attribute",
            "attribute": "breast_cancer_present",
            "operator": "is not nil"
          },
          "transition": "Cancer_present_followup_by_age"
        },
        {
          "transition": "Cancer_not_present_followup_by_age"
        }
      ]
    },

    "Cancer_present_followup_by_age": {
      "type": "Simple",
      "complex_transition": [
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 45,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.734,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.266,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 50,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.825,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.175,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 55,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.826,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.124,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 60,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.857,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.143,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 65,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.847,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.153,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 75,
            "unit": "years"
          },
          "remarks": [
            "65-75 have the same sensitivity"
          ],
          "distributions": [
            {
              "distribution": 0.863,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.137,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 80,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.884,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.116,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": ">=",
            "quantity": 80,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.885,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.115,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        }
      ]
    },

    "Cancer_not_present_followup_by_age": {
      "type": "Simple",
      "complex_transition": [
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 45,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.123,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.877,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 50,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.115,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.885,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },

        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 55,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.096,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.904,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 60,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.083,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.917,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 65,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.078,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.922,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 70,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.073,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.927,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 75,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.067,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.933,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": "<",
            "quantity": 80,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.065,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.935,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Age",
            "operator": ">=",
            "quantity": 80,
            "unit": "years"
          },
          "distributions": [
            {
              "distribution": 0.062,
              "transition": "EncounterFollowupFindings"
            },
            {
              "distribution": 0.938,
              "transition": "EncounterNoFollowupFindings"
            }
          ]
        }
      ]
    },

    "EncounterFollowupFindings": {
      "type": "Observation",
      "category": "imaging",
      "unit": "{score}",
      "codes": [
        {
          "system": "LOINC",
          "code": "26175-0",
          "display": "MG Breast - bilateral screening"
        }
      ],
      "range": {
        "low": 4,
        "high": 5
      },
      "direct_transition": "EncounterEndFollowup"
    },

    "EncounterNoFollowupFindings": {
      "type": "Observation",
      "category": "imaging",
      "unit": "{score}",
      "codes": [
        {
          "system": "LOINC",
          "code": "26175-0",
          "display": "MG Breast - bilateral screening"
        }
      ],
      "range": {
        "low": 1,
        "high": 3
      },
      "direct_transition": "EncounterEndNoDiagnosis"
    },

    "EncounterEndFollowup": {
      "type": "EncounterEnd",
      "distributed_transition": [
        {
          "distribution": 0.233,
          "transition": "ScreeningMammogramFollowupWithin7Days"
        },
        {
          "distribution": 0.363,
          "transition": "ScreeningMammogramFollowup8to14Days"
        },
        {
          "distribution": 0.22,
          "transition": "ScreeningMammogramFollowup15to21Days"
        },
        {
          "distribution": 0.183,
          "transition": "ScreeningMammogramFollowup22to180Days"
        }
      ],
      "remarks": ["followup statistics: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3151253/"]
    },

    "ScreeningMammogramFollowupWithin7Days": {
      "type": "Delay",
      "range": {
        "low": 0,
        "high": 7,
        "unit": "days"
      },
      "direct_transition": "DiagnosticMammogramEncounter"
    },

    "ScreeningMammogramFollowup8to14Days": {
      "type": "Delay",
      "range": {
        "low": 8,
        "high": 14,
        "unit": "days"
      },
      "direct_transition": "DiagnosticMammogramEncounter"
    },

    "ScreeningMammogramFollowup15to21Days": {
      "type": "Delay",
      "range": {
        "low": 15,
        "high": 21,
        "unit": "days"
      },
      "direct_transition": "DiagnosticMammogramEncounter"
    },

    "ScreeningMammogramFollowup22to180Days": {
      "type": "Delay",
      "range": {
        "low": 22,
        "high": 180,
        "unit": "days"
      },
      "direct_transition": "DiagnosticMammogramEncounter"
    },

    "DiagnosticMammogramEncounter": {
      "type": "Encounter",
      "encounter_class": "ambulatory",
      "reason": "breast_cancer",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "50849002",
          "display": "Provider-initiated encounter"
        }
      ],
      "complex_transition": [
        {
          "condition": {
            "condition_type": "Attribute",
            "attribute": "Breast_cancer_present",
            "operator": "==",
            "value": "left"
          },
          "transition": "DiagnosticMammogramLeftBreastProcedure"
        },
        {
          "condition": {
            "condition_type": "Attribute",
            "attribute": "Breast_cancer_present",
            "operator": "==",
            "value": "right"
          },
          "transition": "DiagnosticMammogramRightBreastProcedure"
        },
        {
          "condition": {
            "condition_type": "Attribute",
            "attribute": "Breast_cancer_present",
            "operator": "is nil"
          },
          "distributions": [
            {
              "distribution": 0.5,
              "transition": "DiagnosticMammogramLeftBreastProcedure"
            },
            {
              "distribution": 0.5,
              "transition": "DiagnosticMammogramRightBreastProcedure"
            }
          ]
        }
      ]
    },

    "DiagnosticMammogramLeftBreastProcedure": {
      "type": "Procedure",
      "reason": "breast_cancer",
      "duration": { "low": 1, "high": 2, "unit": "hours" },
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "572701000119102",
          "display": "Mammography of left breast (procedure)"
        }
      ],
      "direct_transition": "DiagnosticMammogramEncounterEnd"
    },

    "DiagnosticMammogramRightBreastProcedure": {
      "type": "Procedure",
      "reason": "breast_cancer",
      "duration": { "low": 1, "high": 2, "unit": "hours" },
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "566571000119105",
          "display": "Mammography of right breast (procedure)"
        }
      ],
      "direct_transition": "DiagnosticMammogramEncounterEnd"
    },

    "DiagnosticMammogramEncounterEnd": {
      "type": "EncounterEnd",
      "direct_transition": "Biopsy_encounter_delay"
    },

    "Biopsy_encounter_delay": {
      "type": "Delay",
      "range": {
        "low": 2,
        "high": 28,
        "unit": "days"
      },
      "remarks": [
        "biopsy delays from https://www.ncbi.nlm.nih.gov/pmc/articles/PMC81326/"
      ],
      "direct_transition": "Biopsy_encounter"
    },

    "Biopsy_encounter": {
      "type": "Encounter",
      "encounter_class": "ambulatory",
      "reason": "breast_cancer",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "165121006",
          "display": "Nonsurgical biopsy done (situation)"
        }
      ],
      "direct_transition": "Biopsy_procedure"
    },

    "Biopsy_procedure": {
      "type": "Procedure",
      "reason": "breast_cancer",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "48635004",
          "display": "Fine needle biopsy (procedure)"
        }
      ],
      "duration": { "low": 20, "high": 60, "unit": "minutes" },
      "remarks": [
        "Biopsy lengths taken from https://www.insideradiology.com.au/breast-core-biopsy/",
        "Biopsy sensitivity/specificity (for the transitions) from https://doi.org/10.1016/j.breast.2016.11.009"
      ],
      "complex_transition": [
        {
          "condition": {
            "condition_type": "Attribute",
            "attribute": "Breast_cancer_present",
            "operator": "is not nil"
          },
          "distributions": [
            {
              "distribution": 0.81,
              "transition": "DiagnosisObservationsSize"
            },
            {
              "distribution": 0.19,
              "transition": "EncounterEndNoDiagnosis"
            }
          ]
        },
        {
          "condition": {
            "condition_type": "Attribute",
            "attribute": "Breast_cancer_present",
            "operator": "is nil"
          },
          "distributions": [
            {
              "distribution": 0.99,
              "transition": "EncounterEndNoDiagnosis"
            },
            {
              "distribution": 0.01,
              "transition": "DiagnosisObservationsSize"
            }
          ]
        }
      ]
    },

    "DiagnosisObservationsSize": {
      "type": "Observation",
      "unit": "mm",
      "range": {
        "low": 1,
        "high": 50
      },
      "codes": [
        {
          "system": "LOINC",
          "code": "21889-1",
          "display": "Size Tumor"
        },
        {
          "system": "LOINC",
          "code": "33728-7",
          "display": "Size.maximum dimension in Tumor"
        }
      ],
      "distributed_transition": [
        {
          "distribution": 0.15,
          "transition": "DiagnosisObservationsExtension"
        },
        {
          "distribution": 0.85,
          "transition": "DiagnosisObservationsNoExtension"
        }
      ],
      "remarks": [
        "Extension/no extension statistics are made up, better statistics need to be sourced"
      ]
    },

    "DiagnosisObservationsExtension": {
      "type": "Observation",
      "unit": "{nominal}",
      "category": "laboratory",
      "codes": [
        {
          "system": "LOINC",
          "code": "21890-9",
          "display": "Extension Cancer"
        }
      ],
      "exact": {
        "quantity": "Extension to the Chest Wall"
      },
      "distributed_transition": [
        {
          "distribution": 0.25,
          "transition": "DiagnosisObservationMetastasis"
        },
        {
          "distribution": 0.75,
          "transition": "DiagnosisObservationNoMetastasis"
        }
      ],
      "remarks": [
        "Metastasis transition stats are made up, better statistics need to be sourced"
      ]
    },

    "DiagnosisObservationsNoExtension": {
      "type": "Observation",
      "unit": "{nominal}",
      "category": "laboratory",
      "codes": [
        {
          "system": "LOINC",
          "code": "21890-9",
          "display": "Extension Cancer"
        }
      ],
      "exact": {
        "quantity": "Extension to the Chest Wall"
      },
      "distributed_transition": [
        {
          "distribution": 0.15,
          "transition": "DiagnosisObservationMetastasis"
        },
        {
          "distribution": 0.85,
          "transition": "DiagnosisObservationNoMetastasis"
        }
      ],
      "remarks": [
        "Metastasis transition stats are made up, better statistics need to be sourced"
      ]
    },

    "DiagnosisObservationMetastasis": {
      "type": "Observation",
      "unit": "{nominal}",
      "category": "laboratory",
      "codes": [
        {
          "system": "LOINC",
          "code": "44667-4",
          "display": "Site of distant metastasis in Breast tumor"
        }
      ],
      "range": {
        "low": 1,
        "high": 8
      },
      "direct_transition": "DiagnosisDR"
    },

    "DiagnosisObservationNoMetastasis": {
      "type": "Observation",
      "unit": "{nominal}",
      "category": "laboratory",
      "codes": [
        {
          "system": "LOINC",
          "code": "44667-4",
          "display": "Site of distant metastasis in Breast tumor"
        }
      ],
      "exact": {
        "quantity": 0
      },
      "direct_transition": "DiagnosisDR"
    },

    "DiagnosisDR": {
      "type": "DiagnosticReport",
      "number_of_observations": 3,
      "codes": [
        {
          "system": "LOINC",
          "code": "49143-1",
          "display": "North American Association of Central Cancer Registries, Inc (NAACCR, Inc) Pathology Laboratory Electronic Reporting panel"
        }
      ],
      "direct_transition": "EncounterEndDiagnosis"
    },

    "BreastCancerDiagnosisEncounter": {
      "type": "Encounter",
      "encounter_class": "ambulatory",
      "reason": "breast_cancer",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "185317003",
          "display": "Telephone encounter (procedure)"
        }
      ],
      "direct_transition": "BreastCancerDiagnosis"
    },

    "BreastCancerDiagnosis": {
      "type": "ConditionOnset",
      "assign_to_attribute": "breast_cancer",
      "target_encounter": "BreastCancerDiagnosisEncounter",
      "codes": [
        {
          "system": "SNOMED-CT",
          "code": "254837009",
          "display": "Malignant neoplasm of breast (disorder)"
        }
      ],
      "direct_transition": "BreastCancerDiagnosisEncounterEnd"
    },

    "BreastCancerDiagnosisEncounterEnd": {
      "type": "EncounterEnd",
      "direct_transition": "Terminal"
    },

    "EncounterEndNoDiagnosis": {
      "type": "EncounterEnd",
      "direct_transition": "Terminal"
    },

    "EncounterEndDiagnosis": {
      "type": "EncounterEnd",
      "direct_transition": "DiagnosisDelay"
    },

    "DiagnosisDelay": {
      "type": "Delay",
      "range": {
        "low": 7,
        "high": 14,
        "unit": "days"
      },
      "direct_transition": "BreastCancerDiagnosisEncounter"
    },

    "Terminal": {
      "type": "Terminal"
    }
  }
}
